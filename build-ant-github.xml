<?xml version="1.0" encoding="UTF-8"?>

<project name="build-ant-github" xmlns:github="antlib:github" default="download-dependencies">
	<!-- you should change the classpath to wherever you have installed the ant-github.jar file -->
	<taskdef uri="antlib:github" resource="synapticloop/github/ant/antlib.xml" classpath="lib/util/ant-github.jar" />

	
	<target name="download-dependencies">
		<!-- nano httpd dependencies -->
		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/LICENSE.md" dest="./NanoHttpd-LICENSE.md" />
		<mkdir dir="src/main/java/fi/iki/elonen/" />

		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/core/src/main/java/fi/iki/elonen/NanoHTTPD.java" dest="src/main/java/fi/iki/elonen/" />
		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/webserver/src/main/java/fi/iki/elonen/ServerRunner.java" dest="src/main/java/fi/iki/elonen/" />

		<!-- nanohttpd has closed off the Response object - change it here -->
		<replaceregexp match="protected Response\(IStatus status, String mimeType, InputStream data, long totalBytes\)" replace="public Response\(IStatus status, String mimeType, InputStream data, long totalBytes\)" flags="g">
			<fileset dir="src/main/java/fi/iki/elonen/" includes="NanoHTTPD.java" />
		</replaceregexp>

		<!-- the following files are ignored, but are uesful for reference -->
		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/webserver/src/main/java/fi/iki/elonen/InternalRewrite.java" dest="src/main/java/fi/iki/elonen/" />
		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/webserver/src/main/java/fi/iki/elonen/SimpleWebServer.java" dest="src/main/java/fi/iki/elonen/" />
		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/webserver/src/main/java/fi/iki/elonen/WebServerPlugin.java" dest="src/main/java/fi/iki/elonen/" />
		<get src="https://raw.githubusercontent.com/NanoHttpd/nanohttpd/master/webserver/src/main/java/fi/iki/elonen/WebServerPluginInfo.java" dest="src/main/java/fi/iki/elonen/" />

		<github:get-release owner="synapticloop" repo="ant-github" asset="ant-github.jar" outDir="lib/util/" overwrite="true" />
		<github:get-release owner="synapticloop" repo="templar" asset="templar.jar" outDir="lib/runtime/" overwrite="true" />
	</target>
</project>
	

